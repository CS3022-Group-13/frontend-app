(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["complaint"],{8471:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",[s("v-main",{staticClass:"bg2"},[s("v-container",{staticClass:"fill-height",staticStyle:{"padding-left":"25%","padding-right":"25%"},attrs:{fluid:""}},[s("ComplaintForm")],1)],1),s("HomeButton")],1)},i=[],o=s("67ae"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{staticClass:"elevation-4  pa-0 white"},[s("v-stepper",{model:{value:e.stepCount,callback:function(t){e.stepCount=t},expression:"stepCount"}},[s("v-stepper-header",[s("v-stepper-step",{attrs:{complete:e.stepCount>1,step:"1"}},[e._v("Customer Details")]),s("v-divider"),s("v-stepper-step",{attrs:{complete:e.stepCount>2,step:"2"}},[e._v("Complaint Details")]),s("v-divider"),s("v-stepper-step",{attrs:{step:"3"}},[e._v("Upload Evidences")])],1),s("v-stepper-items",[s("v-stepper-content",{staticClass:"pa-10",attrs:{step:"1"}},[s("CustomerDetails",{on:{submit:e.submitStep1}})],1),s("v-stepper-content",{staticClass:"pa-10",attrs:{step:"2"}},[s("CustomerDetails",{on:{submit:e.submitStep2}})],1),s("v-stepper-content",{staticClass:"pa-10",attrs:{step:"3"}})],1)],1)],1)},n=[],l=s("79f6"),c=s("8e93"),u={name:"ComplaintForm",components:{CustomerDetails:c["a"]},data:()=>({stepCount:1,loading:!1,userData:{}}),methods:{async submitStep1(e){Object.assign(this.userData,e),this.stepCount=2},async submitStep2(e){Object.assign(this.userData,e),this.loading=!0;const[t,s]=await l["a"].user.register(this.userData);200===s.code?(this.loading=!1,this.stepCount=3):console.log("Registration Failed")}}},d=u,m=s("2877"),p=s("6544"),v=s.n(p),f=s("a523"),h=s("ce7e"),b=s("7e85"),D=s("e516"),g=s("9c54"),C=s("56a4"),x=Object(m["a"])(d,r,n,!1,null,null,null),y=x.exports;v()(x,{VContainer:f["a"],VDivider:h["a"],VStepper:b["a"],VStepperContent:D["a"],VStepperHeader:g["a"],VStepperItems:g["b"],VStepperStep:C["a"]});var E={name:"AddComplaint",components:{ComplaintForm:y,HomeButton:o["a"]}},w=E,O=s("7496"),k=s("f6c4"),$=Object(m["a"])(w,a,i,!1,null,"6195e066",null);t["default"]=$.exports;v()($,{VApp:O["a"],VContainer:f["a"],VMain:k["a"]})},"8e93":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.submit(t)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-row",{staticStyle:{display:"flex"}},[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-text-field",{attrs:{label:"NIC",required:"","prepend-icon":"mdi-card-account-details","append-icon":e.actionIcon,rules:e.rules.nic,loading:e.loadingCustomer},on:{"click:append":e.checkCustomer},model:{value:e.customerData.nic,callback:function(t){e.$set(e.customerData,"nic",t)},expression:"customerData.nic"}})],1)],1),s("v-row",[s("v-col",[s("v-text-field",{attrs:{label:"Full name","prepend-icon":"mdi-rename-box",required:"",rules:e.rules.noneEmpty,disabled:e.alreadyExists},model:{value:e.customerData.fullName,callback:function(t){e.$set(e.customerData,"fullName",t)},expression:"customerData.fullName"}})],1)],1),s("v-row",[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-text-field",{attrs:{label:"Email",required:"","prepend-icon":"mdi-email",rules:e.rules.noneEmpty,disabled:e.alreadyExists},model:{value:e.customerData.email,callback:function(t){e.$set(e.customerData,"email",t)},expression:"customerData.email"}})],1),s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-text-field",{attrs:{label:"Telephone",required:"","prepend-icon":"mdi-phone",rules:e.rules.noneEmpty,disabled:e.alreadyExists},model:{value:e.customerData.telephone,callback:function(t){e.$set(e.customerData,"telephone",t)},expression:"customerData.telephone"}})],1)],1),s("v-row",[s("v-col",[s("v-text-field",{attrs:{label:"Address",required:"","prepend-icon":"mdi-map-marker",rules:e.rules.noneEmpty,disabled:e.alreadyExists},model:{value:e.customerData.address,callback:function(t){e.$set(e.customerData,"address",t)},expression:"customerData.address"}})],1)],1),s("v-row",[s("v-col",[s("v-select",{attrs:{label:"Divisional Secretariat",items:e.divisions,"prepend-icon":"mdi-office-building-marker",required:"",rules:e.rules.noneEmpty,disabled:e.alreadyExists},model:{value:e.customerData.divisionalOffice,callback:function(t){e.$set(e.customerData,"divisionalOffice",t)},expression:"customerData.divisionalOffice"}})],1),s("v-col",[s("v-select",{attrs:{"prepend-icon":"mdi-home-account",label:"GN Office",required:"",items:e.gnOffices,rules:e.rules.noneEmpty,disabled:e.alreadyExists},model:{value:e.customerData.gnOffice,callback:function(t){e.$set(e.customerData,"gnOffice",t)},expression:"customerData.gnOffice"}})],1)],1),s("v-divider"),s("v-row",{staticClass:"mt-5"},[s("v-btn",{staticClass:"ma-1",attrs:{color:"success",type:"submit",width:"100",loading:e.loading,disabled:!e.valid}},[e._v(" "+e._s(e.submitButtonText)+" ")]),s("v-btn",{staticClass:"ma-1",attrs:{text:"",width:"100",color:"secondary"},on:{click:e.cancel}},[e._v(" Cancel ")])],1)],1)},i=[],o=s("79f6"),r={name:"CustomerDetails",data:()=>({valid:!1,loading:!1,loadingCustomer:!1,alreadyExists:!1,customerData:{customerId:"",fullName:"",nic:"",email:"",telephone:"",address:"",divisionalOffice:"",gnOffice:""},rules:{nic:[e=>e.length>=10||"Too short NIC number"],noneEmpty:[e=>e.length>0||"Too short"]}}),computed:{divisions(){return this.$store.getters["utils/getNameOnly_Divisions"]},gnOffices(){return this.$store.getters["utils/getNameOnly_GnOffices"]},actionIcon(){return this.loadingCustomer?"mdi-spin mdi-chart-donut":"mdi-checkbox-marked-circle-outline"},submitButtonText(){return""===this.customerData.customerId?"Save":"Use"}},methods:{async submit(){if(await this.$refs.form.validate(),this.valid){if(this.loading=!0,this.alreadyExists)return void this.$emit("submit",this.customerData.customerId);delete this.customerData.customerId;const[e,t]=await o["a"].customer.addCustomer(this.customerData);if(200!==t.code)return this.$notify(t.message,"error"),void(this.loading=!1);this.$emit("submit",e),this.loading=!1,this.$notify("Customer Details are saved","success")}},cancel(){this.$emit("cancel")},async checkCustomer(){this.loadingCustomer=!0;const[e,t]=await o["a"].customer.getCustomer({nic:this.customerData.nic});if(200!==t.code)return this.$notify(t.message,"error"),void(this.loadingCustomer=!1);if(e.length>0)this.alreadyExists=!0,Object.assign(this.customerData,e[0]),console.log("found");else if(this.alreadyExists){this.alreadyExists=!1;for(let e in this.customerData)"nic"!==e&&(this.customerData[e]="")}this.loadingCustomer=!1}},watch:{async"customerData.nic"(){this.customerData.nic.length>9&&await this.checkCustomer()}}},n=r,l=s("2877"),c=s("6544"),u=s.n(c),d=s("8336"),m=s("62ad"),p=s("ce7e"),v=s("4bd4"),f=s("0fd9"),h=s("b974"),b=s("8654"),D=Object(l["a"])(n,a,i,!1,null,null,null);t["a"]=D.exports;u()(D,{VBtn:d["a"],VCol:m["a"],VDivider:p["a"],VForm:v["a"],VRow:f["a"],VSelect:h["a"],VTextField:b["a"]})},"9c54":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return l}));var a=s("80d2"),i=s("7e85"),o=s("56a4"),r=s("e516");const n=Object(a["h"])("v-stepper__header"),l=Object(a["h"])("v-stepper__items");i["a"],r["a"],o["a"]}}]);
//# sourceMappingURL=complaint.7743760b.js.map